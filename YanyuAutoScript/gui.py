# -*- coding:utf-8 -*-
# 用户：HYL
# 日期：2021年11月17日
import time
from tkinter import Tk, Button
import threading
import uiautomator2 as u2


print('欢迎使用烟雨江湖脚本,本脚本禁止商用。')
print("初始位置在泰山马车处，需要有马车票，使用前请先检查是否有马车票")


class MainWindow(Tk):
    """继承Tk,实例化窗口"""

    def __init__(self):
        super().__init__()
        self.title('烟雨江湖脚本')
        self.geometry('300x300+20+20')
        print('初始化脚本界面')
        self.main_event()
        print('连接模拟器')
        self.device = u2.connect('127.0.0.1:5555')
        print('连接成功')
        print('-------------------------------------------------------------------')

    def main_event(self):
        """事件主体"""
        btn1 = Button(self, text='塞北刷怪', command=lambda: MainWindow.thread_it(self.sai_bei))
        btn1.place(x=20, y=100)
        btn2 = Button(self, text='燕王阁3次', command=lambda: MainWindow.thread_it(self.yan_wang))
        btn2.place(x=100, y=100)
        btn3 = Button(self, text='枯骨门1次', command=lambda: MainWindow.thread_it(self.ku_gu))
        btn3.place(x=180, y=100)
        btn4 = Button(self, text='天一教1次', command=lambda: MainWindow.thread_it(self.tian_yi))
        btn4.place(x=20, y=200)
        btn5 = Button(self, text='铁刃门1次', command=lambda: MainWindow.thread_it(self.tie_ren))
        btn5.place(x=100, y=200)
        btn5 = Button(self, text='一键运行所有', command=lambda: MainWindow.thread_it(self.yi_jian))
        btn5.place(x=180, y=200)

    def sai_bei(self):
        """塞北刷怪"""
        print('泰山到塞北')
        self.device.click(0.214, 0.95)
        time.sleep(2)
        self.device.click(0.312, 0.819)
        time.sleep(2)
        self.device.click(0.362, 0.12)
        time.sleep(5)
        self.device.click(0.224, 0.372)
        time.sleep(5)
        self.device.click(0.096, 0.585)
        time.sleep(6)
        self.device.click(0.43, 0.471)
        time.sleep(6)
        self.device.click(0.268, 0.634)
        time.sleep(6)
        self.device.click(0.432, 0.468)
        time.sleep(6)
        self.device.click(0.108, 0.769)
        time.sleep(6)
        self.device.click(0.21, 0.393)
        time.sleep(6)
        print('开始刷怪')
        for i in range(10):
            self.device.click(0.378, 0.436)
            time.sleep(5)
            self.device.click(0.548, 0.691)
            time.sleep(5)
            self.device.click(0.712, 0.347)
            time.sleep(5)
            self.device.click(0.38, 0.741)
            time.sleep(5)
            self.device.click(0.662, 0.489)
            time.sleep(5)
            self.device.click(0.09, 0.691)
            time.sleep(5)
            self.device.click(0.258, 0.209)
            time.sleep(5)
        print('回到泰山')
        self.device.click(0.258, 0.209)
        time.sleep(5)
        self.device.click(0.198, 0.957)
        time.sleep(3)
        self.device.click(0.274, 0.804)
        time.sleep(3)
        self.device.click(0.742, 0.609)
        time.sleep(3)
        self.device.click(0.592, 0.861)
        time.sleep(10)
        print('刷野完成')

    def yan_wang(self):
        print("""泰山到幽州""")
        self.device.click(0.204, 0.946)
        time.sleep(2)
        self.device.click(0.296, 0.822)
        time.sleep(2)
        self.device.click(0.58, 0.294)
        time.sleep(2)
        self.device.click(0.432, 0.549)
        time.sleep(8)

        print("""走到副本前面""")
        self.device.click(0.672, 0.797)
        time.sleep(5)
        self.device.click(0.212, 0.776)
        time.sleep(5)
        self.device.click(0.658, 0.691)
        time.sleep(5)
        self.device.click(0.688, 0.691)
        time.sleep(5)
        self.device.click(0.734, 0.748)
        time.sleep(5)
        self.device.click(0.736, 0.755)
        time.sleep(5)
        self.device.click(0.552, 0.595)
        time.sleep(5)

        print("""第一次与士兵对话""")
        self.device.click(0.924, 0.539)
        time.sleep(5)
        self.device.click(0.6, 0.436)
        time.sleep(5)
        self.device.click(0.596, 0.421)
        time.sleep(5)
        self.device.click(0.646, 0.439)
        time.sleep(12)

        print("""进入副本打怪""")
        self.device.click(0.66, 0.804)
        time.sleep(5)
        self.device.click(0.774, 0.585)
        time.sleep(5)
        self.device.click(0.718, 0.223)
        time.sleep(5)
        self.device.click(0.712, 0.219)
        time.sleep(5)
        self.device.click(0.6, 0.248)
        time.sleep(5)
        self.device.click(0.606, 0.436)
        time.sleep(5)
        self.device.click(0.708, 0.439)
        time.sleep(5)
        self.device.click(0.368, 0.237)
        time.sleep(5)
        self.device.click(0.264, 0.241)
        time.sleep(5)
        self.device.click(0.152, 0.138)
        time.sleep(5)
        self.device.click(0.484, 0.234)
        time.sleep(5)
        self.device.click(0.608, 0.358)
        time.sleep(5)
        self.device.click(0.44, 0.475)
        time.sleep(5)
        self.device.click(0.496, 0.542)
        time.sleep(5)
        self.device.click(0.486, 0.443)
        time.sleep(5)
        self.device.click(0.384, 0.535)
        time.sleep(5)
        self.device.click(0.438, 0.471)
        time.sleep(5)
        self.device.click(0.328, 0.39)
        time.sleep(5)
        self.device.click(0.602, 0.446)
        time.sleep(12)
        # -------------------------------------
        print("""第二次与士兵对话""")
        self.device.click(0.544, 0.588)  # 走过去
        time.sleep(5)

        self.device.click(0.918, 0.542)
        time.sleep(5)
        self.device.click(0.61, 0.432)
        time.sleep(5)
        self.device.click(0.608, 0.425)
        time.sleep(5)
        self.device.click(0.608, 0.425)
        time.sleep(5)
        self.device.click(0.608, 0.425)
        time.sleep(5)
        self.device.click(0.608, 0.425)
        time.sleep(12)

        print("""进入副本打怪""")
        self.device.click(0.66, 0.804)
        time.sleep(5)
        self.device.click(0.774, 0.585)
        time.sleep(5)
        self.device.click(0.718, 0.223)
        time.sleep(5)
        self.device.click(0.712, 0.219)
        time.sleep(5)
        self.device.click(0.6, 0.248)
        time.sleep(5)
        self.device.click(0.606, 0.436)
        time.sleep(5)
        self.device.click(0.708, 0.439)
        time.sleep(5)
        self.device.click(0.368, 0.237)
        time.sleep(5)
        self.device.click(0.264, 0.241)
        time.sleep(5)
        self.device.click(0.152, 0.138)
        time.sleep(5)
        self.device.click(0.484, 0.234)
        time.sleep(5)
        self.device.click(0.608, 0.358)
        time.sleep(5)
        self.device.click(0.44, 0.475)
        time.sleep(5)
        self.device.click(0.496, 0.542)
        time.sleep(5)
        self.device.click(0.486, 0.443)
        time.sleep(5)
        self.device.click(0.384, 0.535)
        time.sleep(5)
        self.device.click(0.438, 0.471)
        time.sleep(5)
        self.device.click(0.328, 0.39)
        time.sleep(5)
        self.device.click(0.602, 0.446)
        time.sleep(12)

        # --------------------------------------
        print("""第三次与士兵对话""")
        self.device.click(0.544, 0.588)  # 走过去
        time.sleep(5)
        self.device.click(0.918, 0.542)
        time.sleep(5)
        self.device.click(0.61, 0.432)
        time.sleep(5)
        self.device.click(0.608, 0.425)
        time.sleep(5)
        self.device.click(0.608, 0.425)
        time.sleep(5)
        self.device.click(0.608, 0.425)
        time.sleep(5)
        self.device.click(0.608, 0.425)
        time.sleep(12)

        print("""进入副本打怪""")
        self.device.click(0.66, 0.804)
        time.sleep(5)
        self.device.click(0.774, 0.585)
        time.sleep(5)
        self.device.click(0.718, 0.223)
        time.sleep(5)
        self.device.click(0.712, 0.219)
        time.sleep(5)
        self.device.click(0.6, 0.248)
        time.sleep(5)
        self.device.click(0.606, 0.436)
        time.sleep(5)
        self.device.click(0.708, 0.439)
        time.sleep(5)
        self.device.click(0.368, 0.237)
        time.sleep(5)
        self.device.click(0.264, 0.241)
        time.sleep(5)
        self.device.click(0.152, 0.138)
        time.sleep(5)
        self.device.click(0.484, 0.234)
        time.sleep(5)
        self.device.click(0.608, 0.358)
        time.sleep(5)
        self.device.click(0.44, 0.475)
        time.sleep(5)
        self.device.click(0.496, 0.542)
        time.sleep(5)
        self.device.click(0.486, 0.443)
        time.sleep(5)
        self.device.click(0.384, 0.535)
        time.sleep(5)
        self.device.click(0.438, 0.471)
        time.sleep(5)
        self.device.click(0.328, 0.39)
        time.sleep(5)
        self.device.click(0.602, 0.446)
        time.sleep(12)

        print("""回泰山""")
        self.device.click(0.208, 0.946)
        time.sleep(2)
        self.device.click(0.292, 0.815)
        time.sleep(2)
        self.device.click(0.592, 0.613)
        time.sleep(2)
        self.device.click(0.456, 0.861)
        time.sleep(6)

        print('----------------------燕王阁完成-------------------')

    def ku_gu(self):
        print("""从泰山到杭州""")
        self.device.click(0.208, 0.943)
        time.sleep(2)
        self.device.click(0.302, 0.804)
        time.sleep(2)
        self.device.click(0.616, 0.698)
        time.sleep(2)
        self.device.click(0.478, 0.936)
        time.sleep(8)
        print("""走到副本""")
        self.device.click(0.044, 0.734)
        time.sleep(5)
        self.device.click(0.216, 0.294)
        time.sleep(5)
        self.device.click(0.26, 0.326)
        time.sleep(5)
        self.device.click(0.444, 0.18)
        time.sleep(5)
        self.device.click(0.928, 0.546)
        time.sleep(5)
        self.device.click(0.602, 0.432)
        time.sleep(5)
        self.device.click(0.602, 0.432)
        time.sleep(5)
        self.device.click(0.602, 0.432)
        time.sleep(5)
        self.device.click(0.602, 0.432)
        time.sleep(12)

        print("""进入副本开刷""")
        self.device.click(0.808, 0.581)
        time.sleep(5)
        self.device.click(0.548, 0.18)
        time.sleep(5)
        self.device.click(0.214, 0.088)
        time.sleep(5)
        self.device.click(0.772, 0.776)
        time.sleep(5)
        self.device.click(0.665, 0.588)
        time.sleep(5)
        self.device.click(0.688, 0.287)
        time.sleep(5)
        self.device.click(0.712, 0.514)
        time.sleep(5)
        self.device.click(0.49, 0.262)
        time.sleep(5)
        self.device.click(0.748, 0.216)
        time.sleep(5)
        self.device.click(0.654, 0.588)
        time.sleep(5)
        self.device.click(0.596, 0.138)
        time.sleep(5)
        self.device.click(0.768, 0.287)
        time.sleep(5)
        self.device.click(0.494, 0.407)
        time.sleep(8)
        self.device.click(0.662, 0.258)
        time.sleep(5)
        self.device.click(0.152, 0.549)
        time.sleep(5)
        self.device.click(0.608, 0.432)
        time.sleep(12)

        print("""回泰山""")
        self.device.click(0.208, 0.946)
        time.sleep(2)
        self.device.click(0.292, 0.815)
        time.sleep(2)
        self.device.click(0.594, 0.294)
        time.sleep(2)
        self.device.click(0.456, 0.549)
        time.sleep(6)

        print('----------------------枯骨门完成-------------------')

    def tian_yi(self):
        print("""从泰山到成都""")
        self.device.click(0.21, 0.96)
        time.sleep(2)
        self.device.click(0.296, 0.815)
        time.sleep(2)
        self.device.click(0.154, 0.907)
        time.sleep(2)
        self.device.click(0.016, 0.939)
        time.sleep(8)
        print("""走到副本""")
        self.device.click(0.436, 0.797)
        time.sleep(5)
        self.device.click(0.598, 0.734)
        time.sleep(5)
        self.device.click(0.92, 0.535)
        time.sleep(5)
        self.device.click(0.612, 0.436)
        time.sleep(5)
        self.device.click(0.612, 0.436)
        time.sleep(5)
        self.device.click(0.612, 0.436)
        time.sleep(5)
        self.device.click(0.612, 0.436)
        time.sleep(8)
        print("""进入副本刷怪""")
        self.device.click(0.754, 0.79)
        time.sleep(5)
        self.device.click(0.662, 0.585)
        time.sleep(5)
        self.device.click(0.758, 0.776)
        time.sleep(5)
        self.device.click(0.716, 0.539)
        time.sleep(5)
        self.device.click(0.432, 0.287)
        time.sleep(5)
        self.device.click(0.588, 0.23)
        time.sleep(5)
        self.device.click(0.268, 0.241)
        time.sleep(5)
        self.device.click(0.208, 0.109)
        time.sleep(5)
        self.device.click(0.766, 0.202)
        time.sleep(5)
        self.device.click(0.438, 0.599)
        time.sleep(5)
        self.device.click(0.608, 0.425)
        time.sleep(12)

        print("""回泰山""")
        self.device.click(0.208, 0.946)
        time.sleep(2)
        self.device.click(0.292, 0.815)
        time.sleep(2)
        self.device.click(0.938, 0.251)
        time.sleep(2)
        self.device.click(0.794, 0.521)
        time.sleep(6)

        print('----------------------天一教完成-------------------')

    def tie_ren(self):
        print("""泰山到杭州""")
        self.device.click(0.202, 0.946)
        time.sleep(2)
        self.device.click(0.304, 0.819)
        time.sleep(2)
        self.device.click(0.614, 0.698)
        time.sleep(2)
        self.device.click(0.476, 0.946)
        time.sleep(8)
        print("""走到副本""")
        self.device.click(0.048, 0.726)
        time.sleep(5)
        self.device.click(0.214, 0.294)
        time.sleep(5)
        self.device.click(0.248, 0.322)
        time.sleep(5)
        self.device.click(0.206, 0.294)
        time.sleep(5)
        self.device.click(0.104, 0.581)
        time.sleep(5)
        self.device.click(0.146, 0.762)
        time.sleep(5)
        self.device.click(0.264, 0.343)
        time.sleep(5)
        self.device.click(0.606, 0.439)
        time.sleep(5)
        self.device.click(0.606, 0.439)
        time.sleep(12)
        print("""进入副本开刷""")
        self.device.click(0.208, 0.258)
        time.sleep(5)
        self.device.click(0.712, 0.248)
        time.sleep(5)
        self.device.click(0.72, 0.237)
        time.sleep(5)
        self.device.click(0.66, 0.294)
        time.sleep(5)
        self.device.click(0.378, 0.237)
        time.sleep(5)
        self.device.click(0.656, 0.496)
        time.sleep(5)
        self.device.click(0.656, 0.393)
        time.sleep(5)
        self.device.click(0.434, 0.691)
        time.sleep(5)
        self.device.click(0.604, 0.429)
        time.sleep(12)
        print("""回泰山""")
        self.device.click(0.208, 0.946)
        time.sleep(2)
        self.device.click(0.292, 0.815)
        time.sleep(2)
        self.device.click(0.594, 0.294)
        time.sleep(2)
        self.device.click(0.456, 0.549)
        time.sleep(6)

        print("-----------------铁刃门完成--------------------")
        
    def yi_jian(self):
        print("-----------一键任务开始运行--------------")
        self.sai_bei()
        self.yan_wang()
        self.ku_gu()
        self.tian_yi()
        self.tie_ren()
        print("-----------一键任务运行结束--------------")

    @staticmethod
    def thread_it(func, *args):
        """多线程防止阻塞"""
        t = threading.Thread(target=func, args=args)
        t.setDaemon(True)  # 守护
        t.start()  # 启动


if __name__ == '__main__':
    app = MainWindow()
    app.mainloop()